# Методические материалы к занятию «Mediapipe. Модуль Hands».
## Ресурсы

**Проект для занятия:**  https://github.com/vv73/HandsMediapipe.

**Решения заданий:** resourses/hands_sol.ipynb 

**Презентация:**  resourses/presentation.md

## Ход занятия
### План
#### 1. Активизация учащихся

На первом содержательном слайде презентации сразу ссылка на проект и задание. Они запускают программу из подготовленного проекта и сразу видят результат: руку с обозначением ключевых точек. 

**Вопросы учащимся:** 

1. *Как называется и где находится изображение руки, в какой строке происходит его загрузка?* (**Ответ:** pics/hand.jpg, строка 17)
2. *В какой цветовой модели требуется изображение MediaPipe-у* (**Ответ:** RGB, для этого в строке загрузки сразу происходит преобразование.)
3. *Как вы думаете, что означает второй параметр в создании опций* (**Ответ:** максимальное количество рук, которое будет детектировано)

Дальше им сразу предлагается выполнить первое задание из рабочей тетради `hands.ipynb` - переделать программу так, чтобы она работала с видеопотоком. 

**Вопросы учащимся:** 

1. *Какую странность вы наблюдаете, почему возникает проблема и как исправить* (**Ответ:** правая рука распознается как левая и наоборот, потому что Mediapipe считает, что это изображение с селфи-камеры, а там оно отражается по горизонтали. Исправить просто: отражать полученное изображение средствами `numpy`)

#### 2. Обзор библиотеки MediaPipe

Рассказ преподавателя по слайдам 4-6 о возможностях (модулях) библиотеки

#### 3. Ограничения MediaPipe

**Дискуссия с учащимся:** *ИИ начала 2020-x несовершенен. Посмотрите на фото на слайде №7, на которых человек безошибочно детектирует руку, а Mediapipe руки не обнаруживает. Как думаете, почему? Особенно интересно ваше мнение о фотографиях с нормальным освещением.*

#### 4. Работа с модулем Hands

Учитель демонстрирует работу программы со своего ноутбука на проекторе

Добавляет строку `print(detection_result)` и объясняет вывод и дальше выполняет вместе с детьми то, что написано у них в теории.

#### Координаты точек

Учитель демонстрирует работу с точками по теории, показывает только примеры, полный пример учащиеся потом изучают самостоятельно.

#### Самостоятельная работа

Дети самостоятельно изучают работу программы `example.py`

И далее по группам: 

### Младшая группа: Задание №3

*Напишите программу, которая раскрашивает подушечки пальцев в разные цвета*

Эта задача очень простая. Нужно узнать индексы нужных точек и нарисовать разные 
кружочки с центрами в них. Хорошо использовать для этого списки и циклы.


### Старшая группа: Задание №3 (*)

*Напишите программу, которая определяет по видео, когда "видит" кулак, например рисует окружность вокруг кисти разного цвета, когда кулак сжат и разжат.*

Сжатый кулак близок к минимальной окружности его описывающей. А ее диаметр близок к размеру ладони от ее основания до основания указательного пальца. 

![](https://github.com/vv73/HandsMediapipe/raw/master/_common_res/palm.png)

Размер ладони без учета пальцев можно получить при помощи такой функции

```python
def palm_size(landmark, shape):
    x1, y1 = landmark[0].x * shape[1], landmark[0].y * shape[0]
    x2, y2 = landmark[5].x * shape[1], landmark[5].y * shape[0]
    return ((x1 - x2)**2 + (y1 - y2)**2) **.5
```

Индекс 0 соответствует нужней точки кисти, а индекс 5 - косточке указательного пальца.

Для определения описывающей окружности можно воспользоватся функцией OpenCV `minEnclosingCircle()`.

#### 5. Подведение итогов

**Общее обсуждение**

Что изучили, как изученное можно применить в проектах?
